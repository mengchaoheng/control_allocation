clear all;
close all;
clc;

B=[-3.4956, -3.0013, 3.0013, 3.4956;-0.7919, -1.2614, -1.2614, -0.7919];
uMin=[-0.5236;-0.5236;-0.5236;-0.5236];
uMax=-uMin;
yd=[6.5;0.5];

A = [B -yd];
b = -B*uMin;
c = [zeros(4,1);-1];
h = [uMax-uMin; 1];

u_init=[-0.5236; 0.5236;  -0.5236; 0.4861];
m=B*u_init./yd; % lamb

x=[u_init-uMin;0.0594];
e=[1;0;1;1;1];

x(~e)=h(~e)-x(~e);
A(:,~e) = -A(:,~e);
c(~e) = -c(~e);
b = b + A(:,~e)*h(~e);
x=[0, 0, 0, 1.0097, 0.0594]';% that is y0 = A(:,inB)\b
 y0 = A(:,4:5)\b


 yi=[-0.9715;-0.9843];

 (h(4)-y0(1))/-0.9715